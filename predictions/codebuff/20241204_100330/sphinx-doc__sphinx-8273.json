{
    "instance_id": "sphinx-doc__sphinx-8273",
    "model_name_or_path": "codebuff",
    "model_patch": "diff --git a/doc/usage/builders/index.rst b/doc/usage/builders/index.rst\nindex db6706944..dae36ded3 100644\n--- a/doc/usage/builders/index.rst\n+++ b/doc/usage/builders/index.rst\n@@ -263,9 +263,10 @@ name is ``rinoh``. Refer to the `rinohtype manual`_ for details.\n .. module:: sphinx.builders.manpage\n .. class:: ManualPageBuilder\n \n-   This builder produces manual pages in the groff format.  You have to specify\n-   which documents are to be included in which manual pages via the\n-   :confval:`man_pages` configuration value.\n+   This builder produces manual pages in the groff format organized into section\n+   directories (e.g., man1, man2, etc.).  You have to specify which documents\n+   are to be included in which manual pages via the :confval:`man_pages`\n+   configuration value.\n \n    .. autoattribute:: name\n \ndiff --git a/sphinx/builders/manpage.py b/sphinx/builders/manpage.py\nindex 4166dece9..282c0bc9c 100644\n--- a/sphinx/builders/manpage.py\n+++ b/sphinx/builders/manpage.py\n@@ -8,7 +8,7 @@\n     :license: BSD, see LICENSE for details.\n \"\"\"\n \n-from os import path\n+from os import path, makedirs\n from typing import Any, Dict, List, Set, Tuple, Union\n \n from docutils.frontend import OptionParser\n@@ -80,10 +80,15 @@ class ManualPageBuilder(Builder):\n             docsettings.authors = authors\n             docsettings.section = section\n \n+            # Create section directory if it doesn't exist\n+            section_dir = path.join(self.outdir, 'man%s' % section)\n+            if not path.exists(section_dir):\n+                os.makedirs(section_dir)\n+\n             targetname = '%s.%s' % (name, section)\n             logger.info(darkgreen(targetname) + ' { ', nonl=True)\n             destination = FileOutput(\n-                destination_path=path.join(self.outdir, targetname),\n+                destination_path=path.join(section_dir, targetname),\n                 encoding='utf-8')\n \n             tree = self.env.get_doctree(docname)\ndiff --git a/tests/test_build_manpage.py b/tests/test_build_manpage.py\nindex c3c41a2ae..019e9a577 100644\n--- a/tests/test_build_manpage.py\n+++ b/tests/test_build_manpage.py\n@@ -17,9 +17,9 @@ from sphinx.config import Config\n @pytest.mark.sphinx('man')\n def test_all(app, status, warning):\n     app.builder.build_all()\n-    assert (app.outdir / 'sphinxtests.1').exists()\n+    assert (app.outdir / 'man1' / 'sphinxtests.1').exists()\n \n-    content = (app.outdir / 'sphinxtests.1').read_text()\n+    content = (app.outdir / 'man1' / 'sphinxtests.1').read_text()\n     assert r'\\fBprint \\fP\\fIi\\fP\\fB\\en\\fP' in content\n     assert r'\\fBmanpage\\en\\fP' in content\n \n",
    "cost": 0,
    "edit_outcome": true,
    "lint_outcome": true,
    "test_outcome": false,
    "resolved": false
}